# -*- coding: utf-8 -*-
"""ETL.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1AbSFyw6V9znHIXzr7-7Q5bhPv69SmO7i
"""

#EXTRACTING THE DATA

import pandas as pd
data_path = "/content/data.csv"
df = pd.read_csv(data_path)

#TRANSFORMING THE DATA BEFORE LOADING

#Handling duplicate values
df = df.drop_duplicates()

#Handling misssing values
df = df.fillna(df.mean())

#Handling wrong values
df['Maxpulse'] = df['Maxpulse'].apply(lambda x: abs(x) if x < 0 else x)

#Rename columns
df.rename(columns={
    'Duration': 'Duration_for_Cal_Burnage',
    'Pulse': 'Pulse_Rate_Normal',
    'Maxpulse': 'MaxPulse_Post_Burnage',
    'Calories': 'Cal_Burnt',
}, inplace=True)

#LOADING THE DATA INTO A NEW CSV FILE
df.to_csv("transformed_data.csv", index=False)
print("ETL operations have been executed")

